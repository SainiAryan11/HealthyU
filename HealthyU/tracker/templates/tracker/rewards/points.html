{% extends "tracker/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'tracker/css/components/detail_page.css' %}">
<link rel="stylesheet" href="{% static 'tracker/css/pages/rewards/points.css' %}">
{% endblock %}


{% block content %}

<a href="{% url 'home' %}" class="back-button">
    <span class="back-icon">←</span> Back to Home
</a>

<div class="container ph-wrap">
  <div class="ph-card">
    <div class="ph-head">
      <div>
        <h2>Points History</h2>
        <p class="ph-sub">Date • Points earned • Source (Session / Challenge)</p>
      </div>
      <div class="ph-points">Total: {{ profile.points }} pts</div>
    </div>

    {% if not txns %}
    <div class="empty">No points history yet. Complete a session or challenge to earn points.</div>
    {% else %}
    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th style="width: 210px;">Date</th>
            <th style="width: 120px;">Points</th>
            <th style="width: 140px;">Source</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          {% for t in txns %}
          <tr>
            <td>{{ t.date|date:"d M Y, h:i A" }}</td>
            <td class="pts">+{{ t.points }}</td>
            <td>
              {% if t.source == "session" %}
              <span class="tag session">Session</span>
              {% else %}
              <span class="tag challenge">Challenge</span>
              {% endif %}
            </td>
            <td>{{ t.note|default:"-" }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'tracker/js/pages/rewards/points.js' %}"></script>
{% endblock %}