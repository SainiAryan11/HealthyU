{% extends "tracker/base.html" %}

{% block content %}
<style>
  .ph-wrap{ padding: 24px 0; max-width: 950px; margin: 0 auto; }
  .ph-card{
    background:#fff; border-radius:16px; padding:18px;
    box-shadow: 0 8px 24px rgba(0,0,0,.06);
    border: 1px solid #eef2f7;
  }
  .ph-head{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom: 14px; }
  .ph-head h2{ margin:0; font-weight:900; color:#111827; }
  .ph-sub{ margin:0; color:#6b7280; font-weight:600; }
  .ph-points{ font-weight:900; padding:8px 12px; border-radius:999px; background:#eef2ff; color:#3730a3; }
  table{ width:100%; border-collapse: collapse; }
  th, td{ padding: 12px 10px; border-bottom: 1px solid #eef2f7; }
  th{ text-align:left; color:#374151; font-weight:900; font-size: 13px; }
  td{ color:#111827; font-weight:600; font-size: 14px; vertical-align: top; }
  .tag{
    display:inline-flex; padding:6px 10px; border-radius:999px;
    font-size:12px; font-weight:900; background:#f3f4f6; color:#374151;
  }
  .tag.session{ background:#eef2ff; color:#3730a3; }
  .tag.challenge{ background:#ecfdf5; color:#065f46; }
  .pts{ font-weight:900; color:#16a34a; }
  .empty{
    padding: 14px; border-radius: 12px; background:#fff7ed; color:#9a3412;
    font-weight:800;
  }
</style>

<div class="container ph-wrap">
  <div class="ph-card">
    <div class="ph-head">
      <div>
        <h2>Points History</h2>
        <p class="ph-sub">Date • Points earned • Source (Session / Challenge)</p>
      </div>
      <div class="ph-points">Total: {{ profile.points }} pts</div>
    </div>

    {% if not txns %}
      <div class="empty">No points history yet. Complete a session or challenge to earn points.</div>
    {% else %}
      <div class="table-responsive">
        <table>
          <thead>
            <tr>
              <th style="width: 210px;">Date</th>
              <th style="width: 120px;">Points</th>
              <th style="width: 140px;">Source</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            {% for t in txns %}
              <tr>
                <td>{{ t.date|date:"d M Y, h:i A" }}</td>
                <td class="pts">+{{ t.points }}</td>
                <td>
                  {% if t.source == "session" %}
                    <span class="tag session">Session</span>
                  {% else %}
                    <span class="tag challenge">Challenge</span>
                  {% endif %}
                </td>
                <td>{{ t.note|default:"-" }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
